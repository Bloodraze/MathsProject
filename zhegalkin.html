<!DOCTYPE html>
<html>
<head>
    <title>–ü–æ–ª–∏–Ω–æ–º –ñ–µ–≥–∞–ª–∫–∏–Ω–∞ ‚úì</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.26.1/full/pyodide.js"></script>
    <style>
        body { font-family: 'Segoe UI', Arial; max-width: 900px; margin: 40px auto; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .container { background: rgba(255,255,255,0.1); padding: 30px; border-radius: 15px; backdrop-filter: blur(10px); }
        h1 { text-align: center; font-size: 2.2em; margin-bottom: 10px; }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        textarea { height: 90px; resize: vertical; }
        button { padding: 12px 24px; margin: 8px 4px 8px 0; background: #00d4aa; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; transition: all 0.3s; }
        button:hover { background: #00b894; transform: translateY(-2px); }
        button:disabled { background: #636e72; cursor: not-allowed; transform: none; }
        #output { background: rgba(0,0,0,0.3); color: #fff; padding: 20px; border-radius: 10px; white-space: pre-wrap; font-family: monospace; font-size: 14px; max-height: 400px; overflow-y: auto; margin-top: 20px; }
        .status { text-align: center; padding: 10px; border-radius: 8px; margin: 10px 0; }
        .loading { background: rgba(255,193,7,0.3); }
        .ready { background: rgba(40,167,69,0.3); }
        .example-btn { background: #fdcb6e; }
        .example-btn:hover { background: #f39c12; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¢ –ü–æ–ª–∏–Ω–æ–º –ñ–µ–≥–∞–ª–∫–∏–Ω–∞</h1>
        <p style="text-align: center; opacity: 0.9;">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±—É–ª–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –º–µ—Ç–æ–¥–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –ü–∞—Å–∫–∞–ª—è</p>
        
        <div>
            <label>–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (1-5):</label>
            <input type="number" id="n_vars" min="1" max="5" value="2">
        </div>
        
        <label>–§—É–Ω–∫—Ü–∏—è (and, or, not):</label>
        <textarea id="func_input" placeholder="–ü—Ä–∏–º–µ—Ä—ã:
x1 and x2
not x1 or x2  
(x1 and x2) or not x3
x1 and (not x2 or x3)">x1 and x2</textarea>
        
        <div>
            <button onclick="compute()" id="computeBtn">üöÄ –í—ã—á–∏—Å–ª–∏—Ç—å –ø–æ–ª–∏–Ω–æ–º</button>
            <button class="example-btn" onclick="loadExample(0)">–ü—Ä–∏–º–µ—Ä 1</button>
            <button class="example-btn" onclick="loadExample(1)">–ü—Ä–∏–º–µ—Ä 2</button>
            <button class="example-btn" onclick="loadExample(2)">–ü—Ä–∏–º–µ—Ä 3</button>
            <button onclick="showHelp()">‚ÑπÔ∏è –ü–æ–º–æ—â—å</button>
        </div>
        
        <div id="status" class="status">–ó–∞–≥—Ä—É–∑–∫–∞ Python...</div>
        <div id="output"></div>
    </div>

    <script type="text/javascript">
        let pyodideReady = false;
        let pyodide;
        
        const examples = [
            {n: 3, func: "x1 and x2 and x3"},
            {n: 2, func: "x1 or x2"},
            {n: 1, func: "not x1"},
            {n: 3, func: "(x1 and x2) or (x1 and x3) or (x2 and x3)"},
            {n: 4, func: "x1 and (not x2 or x3) and x4"}
        ];

        async function initPyodide() {
            try {
                pyodide = await loadPyodide({
                    indexURL: "https://cdn.jsdelivr.net/pyodide/v0.26.1/full/"
                });
                pyodideReady = true;
                document.getElementById('status').textContent = '‚úÖ Python –≥–æ—Ç–æ–≤!';
                document.getElementById('status').className = 'status ready';
                document.getElementById('computeBtn').disabled = false;
            } catch (error) {
                document.getElementById('status').textContent = '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message;
                document.getElementById('status').className = 'status';
            }
        }

        async function compute() {
        if (!pyodideReady) {
            document.getElementById('output').textContent = 'Python –µ—â–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...';
            return;
        }
        
        const n = parseInt(document.getElementById('n_vars').value);
        const func_str = document.getElementById('func_input').value.trim();
        
        if (!func_str) {
            document.getElementById('output').textContent = '–í–≤–µ–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é!';
            return;
        }

        document.getElementById('status').textContent = '–í—ã—á–∏—Å–ª—è–µ–º...';
        document.getElementById('status').className = 'status loading';
        
        try {
            const code = `
    import sys
    import io

    output = io.StringIO()
    sys.stdout = output

    def get_truth_table(func, n):
        truth_table = []
        for i in range(2**n):
            binary = format(i, f'0{n}b')
            args = [int(bit) for bit in binary]
            value = func(*args)
            truth_table.append((args, value))
        return truth_table

    def triangle_method(truth_table):
        n = len(truth_table[0][0]) 
        values = [row[1] for row in truth_table]
        triangle = [values.copy()]
        for i in range(len(values) - 1):
            new_row = []
            for j in range(len(triangle[i]) - 1):
                new_row.append(triangle[i][j] ^ triangle[i][j + 1])
            triangle.append(new_row)
        coefficients = [row[0] for row in triangle]
        return coefficients

    def build_zhegalkin_polynomial(coefficients, n):
        terms = []
        for i, coef in enumerate(coefficients):
            if coef == 1:
                binary = format(i, f'0{n}b')
                monom_terms = []
                for j, bit in enumerate(binary):
                    if bit == '1':
                        monom_terms.append(f"x{j+1}")
                if not monom_terms:
                    terms.append("1")
                else:
                    terms.append(" ‚àß ".join(monom_terms))
        if not terms:
            return "0"
        return " ‚äï ".join(terms)

    def parse_boolean_function(func_str, n):
        namespace = {}
        def AND(a, b): return a and b
        def OR(a, b): return a or b
        def NOT(a): return 1 if not a else 0
        namespace.update({'and': AND, 'AND': AND, 'or': OR, 'OR': OR, 'not': NOT, 'NOT': NOT})
        for i in range(1, n + 1):
            namespace[f'x{i}'] = None
        def boolean_func(*args):
            for i in range(n):
                namespace[f'x{i+1}'] = args[i]
            try:
                result = eval(func_str, {"__builtins__": {}}, namespace)
                return 1 if result else 0
            except:
                return 0
        return boolean_func

    func = parse_boolean_function(r'${func_str.replace(/'/g, "\\'")}', ${n})
    truth_table = get_truth_table(func, ${n})
    coefficients = triangle_method(truth_table)
    poly = build_zhegalkin_polynomial(coefficients, ${n})

    print("üìä –§—É–Ω–∫—Ü–∏—è:", r'${func_str}')
    print("üéØ –ü–æ–ª–∏–Ω–æ–º –ñ–µ–≥–∞–ª–∫–∏–Ω–∞:", poly)
    print("\\nüìã –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–∏–Ω–Ω–æ—Å—Ç–∏:")
    print("-" * 40)
    for args, value in truth_table:
        print(f"{args} ‚Üí {value}")

    sys.stdout = sys.__stdout__
    output.getvalue()
    `;

            let result = await pyodide.runPythonAsync(code);
            document.getElementById('output').textContent = result.trim();
        } catch (error) {
            document.getElementById('output').textContent = `‚ùå –û—à–∏–±–∫–∞: ${error.message}\n\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Ñ—É–Ω–∫—Ü–∏–∏!`;
        }
        
        document.getElementById('status').textContent = '–ì–æ—Ç–æ–≤–æ!';
        document.getElementById('status').className = 'status ready';
    }

        function loadExample(idx) {
            const ex = examples[idx];
            document.getElementById('n_vars').value = ex.n;
            document.getElementById('func_input').value = ex.func;
        }

        function showHelp() {
            document.getElementById('output').textContent = `üìñ –°–ø—Ä–∞–≤–∫–∞ –ø–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É:

–û–ø–µ—Ä–∞—Ü–∏–∏:
‚Ä¢ and / AND - –∫–æ–Ω—ä—é–Ω–∫—Ü–∏—è (–ò)
‚Ä¢ or / OR  - –¥–∏–∑—ä—é–Ω–∫—Ü–∏—è (–ò–õ–ò)  
‚Ä¢ not / NOT - –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ (–ù–ï)

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: x1, x2, x3, x4, x5

–ü—Ä–∏–º–µ—Ä—ã:
1. x1 and x2 and x3                    ‚Üí x1‚àßx2‚àßx3
2. x1 or x2                            ‚Üí x1‚äïx2‚äï1  
3. not x1                              ‚Üí x1‚äï1
4. (x1 and x2) or (not x3)             ‚Üí x1‚àßx2‚äïx3‚äïx1‚àßx2‚àßx3
5. x1 xor x2 = (x1 and not x2) or (not x1 and x2)

–°–∫–æ–±–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –ø–æ—Ä—è–¥–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π!
–ú–∞–∫—Å. 5 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (32 —Å—Ç—Ä–æ–∫–∏).`;
        }

        // –ó–∞–ø—É—Å–∫
        initPyodide();
    </script>
</body>
</html>
